#!/bin/bash
# Pre-commit hook: Validate append-only files
# Install: ln -sf ../../.harness/hooks/pre-commit .git/hooks/pre-commit

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Run the validation script
python3 "$PROJECT_ROOT/.harness/scripts/validate-append-only.py"
exit_code=$?

if [ $exit_code -ne 0 ]; then
    echo ""
    echo "Commit blocked by append-only validation."
    echo "See above for details."
    exit 1
fi

exit 0
